export type BumpkinLevel =
  | 1
  | 2
  | 3
  | 4
  | 5
  | 6
  | 7
  | 8
  | 9
  | 10
  | 11
  | 12
  | 13
  | 14
  | 15
  | 16
  | 17
  | 18
  | 19
  | 20
  | 21
  | 22
  | 23
  | 24
  | 25
  | 26
  | 27
  | 28
  | 29
  | 30
  | 31
  | 32
  | 33
  | 34
  | 35
  | 36
  | 37
  | 38
  | 39
  | 40
  | 41
  | 42
  | 43
  | 44
  | 45
  | 46
  | 47
  | 48
  | 49
  | 50
  | 51
  | 52
  | 53
  | 54
  | 55
  | 56
  | 57
  | 58
  | 59
  | 60
  | 61
  | 62
  | 63
  | 64
  | 65
  | 66
  | 67
  | 68
  | 69
  | 70
  | 71
  | 72
  | 73
  | 74
  | 75
  | 76
  | 77
  | 78
  | 79
  | 80
  | 81
  | 82
  | 83
  | 84
  | 85
  | 86
  | 87
  | 88
  | 89
  | 90
  | 91
  | 92
  | 93
  | 94
  | 95
  | 96
  | 97
  | 98
  | 99
  | 100
  | 101
  | 102
  | 103
  | 104
  | 105
  | 106
  | 107
  | 108
  | 109
  | 110
  | 111
  | 112
  | 113
  | 114
  | 115
  | 116
  | 117
  | 118
  | 119
  | 120
  | 121
  | 122
  | 123
  | 124
  | 125
  | 126
  | 127
  | 128
  | 129
  | 130
  | 131
  | 132
  | 133
  | 134
  | 135
  | 136
  | 137
  | 138
  | 139
  | 140
  | 141
  | 142
  | 143
  | 144
  | 145
  | 146
  | 147
  | 148
  | 149
  | 150
  | 151
  | 152
  | 153
  | 154
  | 155
  | 156
  | 157
  | 158
  | 159
  | 160
  | 161
  | 162
  | 163
  | 164
  | 165
  | 166
  | 167
  | 168
  | 169
  | 170
  | 171
  | 172
  | 173
  | 174
  | 175
  | 176
  | 177
  | 178
  | 179
  | 180
  | 181
  | 182
  | 183
  | 184
  | 185
  | 186
  | 187
  | 188
  | 189
  | 190
  | 191
  | 192
  | 193
  | 194
  | 195
  | 196
  | 197
  | 198
  | 199
  | 200;

export const LEVEL_EXPERIENCE: Record<BumpkinLevel, number> = {
  1: 0,
  2: 2,
  3: 22,
  4: 205,
  5: 555,
  6: 1_155,
  7: 2_155,
  8: 3_405,
  9: 5_405,
  10: 7_905,
  11: 10_905,
  12: 14_405,
  13: 18_405,
  14: 22_905,
  15: 27_905,
  16: 33_655,
  17: 40_155,
  18: 47_405,
  19: 55_405,
  20: 64_155,
  21: 73_905,
  22: 84_655,
  23: 96_405,
  24: 109_155,
  25: 122_905,
  26: 137_405,
  27: 152_905,
  28: 169_405,
  29: 186_905,
  30: 205_405,
  31: 225_405,
  32: 246_905,
  33: 269_905,
  34: 294_405,
  35: 320_405,
  36: 348_405,
  37: 378_405,
  38: 410_405,
  39: 444_405,
  40: 480_405,
  41: 518_905,
  42: 559_905,
  43: 603_405,
  44: 649_405,
  45: 697_905,
  46: 749_405,
  47: 803_905,
  48: 861_405,
  49: 921_905,
  50: 985_405,
  51: 1_053_905,
  52: 1_127_405,
  53: 1_205_905,
  54: 1_289_405,
  55: 1_377_905,
  56: 1_476_405,
  57: 1_584_905,
  58: 1_703_405,
  59: 1_831_905,
  60: 1_970_405,
  61: 2_128_905,
  62: 2_287_405,
  63: 2_485_905,
  64: 2_704_405,
  65: 2_942_905,
  66: 3_221_405,
  67: 3_539_905,
  68: 3_898_405,
  69: 4_296_905,
  70: 4_735_405,
  71: 5_233_905,
  72: 5_743_905,
  73: 6_263_905,
  74: 6_793_905,
  75: 7_333_905,
  76: 7_883_905,
  77: 8_443_905,
  78: 9_013_905,
  79: 9_593_905,
  80: 10_183_905,
  81: 10_783_905,
  82: 11_393_905,
  83: 12_013_905,
  84: 12_643_905,
  85: 13_283_905,
  86: 13_933_905,
  87: 14_593_905,
  88: 15_263_905,
  89: 15_943_905,
  90: 16_633_905,
  91: 17_333_905,
  92: 18_043_905,
  93: 18_763_905,
  94: 19_493_905,
  95: 20_233_905,
  96: 20_983_905,
  97: 21_743_905,
  98: 22_513_905,
  99: 23_293_905,
  100: 24_083_905,
  101: 24_893_905,
  102: 25_723_905,
  103: 26_573_905,
  104: 27_443_905,
  105: 28_333_905,
  106: 29_243_905,
  107: 30_173_905,
  108: 31_123_905,
  109: 32_093_905,
  110: 33_083_905,
  111: 34_093_905,
  112: 35_123_905,
  113: 36_173_905,
  114: 37_243_905,
  115: 38_333_905,
  116: 39_443_905,
  117: 40_573_905,
  118: 41_723_905,
  119: 42_893_905,
  120: 44_083_905,
  121: 45_293_905,
  122: 46_523_905,
  123: 47_773_905,
  124: 49_043_905,
  125: 50_333_905,
  126: 51_653_905,
  127: 53_003_905,
  128: 54_383_905,
  129: 55_793_905,
  130: 57_233_905,
  131: 58_708_905,
  132: 60_218_905,
  133: 61_763_905,
  134: 63_343_905,
  135: 64_958_905,
  136: 66_613_905,
  137: 68_308_905,
  138: 70_043_905,
  139: 71_818_905,
  140: 73_633_905,
  141: 75_493_905,
  142: 77_398_905,
  143: 79_348_905,
  144: 81_343_905,
  145: 83_383_905,
  146: 85_473_905,
  147: 87_613_905,
  148: 89_803_905,
  149: 92_043_905,
  150: 93_333_905,
  151: 94_662_605,
  152: 96_031_166,
  153: 97_440_783,
  154: 98_892_688,
  155: 100_388_150,
  156: 101_928_475,
  157: 103_515_009,
  158: 105_149_139,
  159: 106_832_292,
  160: 108_565_939,
  161: 110_351_595,
  162: 112_190_820,
  163: 114_085_221,
  164: 116_036_454,
  165: 118_046_223,
  166: 120_116_285,
  167: 122_248_448,
  168: 124_444_575,
  169: 126_706_585,
  170: 129_036_455,
  171: 131_436_221,
  172: 133_907_979,
  173: 136_453_889,
  174: 139_076_176,
  175: 141_777_131,
  176: 144_559_114,
  177: 147_424_556,
  178: 150_375_961,
  179: 153_415_908,
  180: 156_547_053,
  181: 159_772_132,
  182: 163_093_963,
  183: 166_515_448,
  184: 170_039_577,
  185: 173_669_429,
  186: 177_408_176,
  187: 181_259_085,
  188: 185_225_521,
  189: 189_310_950,
  190: 193_518_941,
  191: 197_853_171,
  192: 202_317_427,
  193: 206_915_610,
  194: 211_651_738,
  195: 216_529_949,
  196: 221_554_506,
  197: 226_729_799,
  198: 232_060_350,
  199: 237_550_817,
  200: 243_205_998,
};

export const MAX_BUMPKIN_LEVEL: BumpkinLevel = 200;

export const isMaxLevel = (experience: number): boolean => {
  return experience >= LEVEL_EXPERIENCE[MAX_BUMPKIN_LEVEL];
};

export const getBumpkinLevel = (experience: number): BumpkinLevel => {
  let bumpkinLevel: BumpkinLevel = 1;
  for (const key in LEVEL_EXPERIENCE) {
    const level = Number(key) as BumpkinLevel;
    if (isMaxLevel(experience)) {
      bumpkinLevel = MAX_BUMPKIN_LEVEL;
    } else if (experience >= LEVEL_EXPERIENCE[level]) {
      bumpkinLevel = level;
    } else {
      break;
    }
  }
  return bumpkinLevel;
};

export const getExperienceToNextLevel = (experience: number) => {
  const level = getBumpkinLevel(experience);

  const nextLevelExperience = LEVEL_EXPERIENCE[(level + 1) as BumpkinLevel];
  const currentLevelExperience = LEVEL_EXPERIENCE[level] || 0;

  const currentExperienceProgress = experience - currentLevelExperience;
  const experienceToNextLevel = nextLevelExperience - currentLevelExperience;

  if (level === MAX_BUMPKIN_LEVEL) {
    return {
      currentExperienceProgress,
      experienceToNextLevel:
        LEVEL_EXPERIENCE[MAX_BUMPKIN_LEVEL] -
        LEVEL_EXPERIENCE[(MAX_BUMPKIN_LEVEL - 1) as BumpkinLevel],
    };
  }

  return {
    currentExperienceProgress,
    experienceToNextLevel,
  };
};
